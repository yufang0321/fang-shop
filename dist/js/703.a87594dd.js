"use strict";(self["webpackChunkfang_shop"]=self["webpackChunkfang_shop"]||[]).push([[703],{5703:function(t,l,a){a.r(l),a.d(l,{default:function(){return B}});var e=a(3396),s=a(7139),o=a(9242);const i={class:"container"},n={class:"row mt-4"},d={class:"col-md-7"},r={class:"table align-middle"},u=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"圖片"),(0,e._)("th",null,"商品名稱"),(0,e._)("th",null,"價格"),(0,e._)("th",null,"數量"),(0,e._)("th")])],-1),c={style:{width:"200px"}},p=["onClick"],h={key:0,class:"h5"},g={key:1,class:"h6"},b={key:2,class:"h5"},_={class:"btn-toolbar justify-content-between",role:"toolbar","aria-label":"Toolbar with button groups"},y={class:"btn-group",role:"group","aria-label":"First group"},m=["onClick"],k=["onUpdate:modelValue"],w=["onClick"],v={class:"btn-group btn-group-sm"},C=["onClick"],f=(0,e._)("i",{class:"bi bi-three-dots"},null,-1),q=[f],$=["disabled","onClick"],x={key:0,class:"spinner-grow text-danger spinner-grow-sm",role:"status"},D=(0,e._)("span",{class:"visually-hidden"},"Loading...",-1),I=[D],z=(0,e._)("i",{class:"bi bi-cart-plus"},null,-1),P={class:"col-md-5"},L={class:"table align-middle"},U=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"品名"),(0,e._)("th",null,"單價"),(0,e._)("th",null,"數量"),(0,e._)("th")])],-1),Q={class:"h5"},V={class:"h5"},j={class:"btn-toolbar justify-content-between",role:"toolbar","aria-label":"Toolbar with button groups"},H={class:"btn-group",role:"group","aria-label":"First group"},Y=["onChange","disabled","onUpdate:modelValue"],F=["onClick"],K=(0,e._)("i",{class:"bi bi-trash3"},null,-1),T=[K],M={class:"text-end h5"};function S(t,l,a,f,D,K){const S=(0,e.up)("LoadingComponent");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e.Wm)(S,{active:t.isLoading},null,8,["active"]),(0,e._)("div",i,[(0,e._)("div",n,[(0,e._)("div",d,[(0,e._)("table",r,[u,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(D.products,(t=>((0,e.wg)(),(0,e.iD)("tr",{key:t.id},[(0,e._)("td",c,[(0,e._)("div",{style:(0,s.j5)([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.imageUrl})`}])},null,4)]),(0,e._)("td",null,[(0,e._)("a",{class:"text-dark",onClick:l=>K.getProduct(t.id)},(0,s.zw)(t.title),9,p)]),(0,e._)("td",null,[t.price?(0,e.kq)("",!0):((0,e.wg)(),(0,e.iD)("div",h,(0,s.zw)(t.origin_price)+" 元",1)),t.price?((0,e.wg)(),(0,e.iD)("del",g,"原價 "+(0,s.zw)(t.origin_price)+" 元",1)):(0,e.kq)("",!0),t.price?((0,e.wg)(),(0,e.iD)("div",b,"現在只要 "+(0,s.zw)(t.price)+" 元",1)):(0,e.kq)("",!0)]),(0,e._)("td",null,[(0,e._)("div",_,[(0,e._)("div",y,[(0,e._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:l=>K.deleteQty(t)},"-",8,m),(0,e.wy)((0,e._)("input",{type:"number",class:"form-control","onUpdate:modelValue":l=>t.qty=l},null,8,k),[[o.nr,t.qty]]),(0,e._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:l=>K.addQty(t)},"+",8,w)])])]),(0,e._)("td",null,[(0,e._)("div",v,[(0,e._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:l=>K.getProduct(t.id)},q,8,C),(0,e._)("button",{type:"button",class:"btn btn-outline-danger",disabled:this.status.loadingItem===t.id,onClick:l=>K.addCart(t.id,t.qty)},[this.status.loadingItem===t.id?((0,e.wg)(),(0,e.iD)("div",x,I)):(0,e.kq)("",!0),z],8,$)])])])))),128))])])]),(0,e._)("div",P,[(0,e._)("table",L,[U,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(D.carts,(t=>((0,e.wg)(),(0,e.iD)("tr",{key:t.id},[(0,e._)("td",null,[(0,e._)("a",Q,(0,s.zw)(t.product.title),1)]),(0,e._)("td",null,[(0,e._)("div",V,(0,s.zw)(t.product.price)+" 元",1)]),(0,e._)("td",null,[(0,e._)("div",j,[(0,e._)("div",H,[(0,e.wy)((0,e._)("input",{type:"number",min:"1",onChange:l=>K.updateCart(t),disabled:t.id===D.status.loadingItem,class:"form-control","onUpdate:modelValue":l=>t.qty=l},null,40,Y),[[o.nr,t.qty]])])])]),(0,e._)("td",null,[(0,e._)("button",{type:"button",class:"btn btn-outline-danger",onClick:l=>K.deleteProduct(t.id)},T,8,F)])])))),128))])]),(0,e._)("div",null,[(0,e._)("p",M,"總計："+(0,s.zw)(D.order.final_total),1)])])])])],64)}a(560);var W={data(){return{products:[],product:{},carts:[],order:{},status:{loadingItem:""}}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/yufang-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products.filter(((t,l,a)=>(t.qty=0,t))),console.log("products:",this.products),this.isLoading=!1}))},getProduct(t){this.$router.push(`/user/product/${t}`)},addCart(t,l){const a="https://vue3-course-api.hexschool.io/api/yufang-api/cart";this.status.loadingItem=t;const e={product_id:t,qty:0===l?1:l};this.$http.post(a,{data:e}).then((t=>{this.status.loadingItem="",this.getCart()})),console.log("item.id:",t,"item.qty:",l)},addQty(t){t.qty+=1},deleteQty(t){t.qty>0&&(t.qty-=1)},getCart(){const t="https://vue3-course-api.hexschool.io/api/yufang-api/cart";this.$http.get(t).then((t=>{console.log("getCart:",t.data.data),this.carts=t.data.data.carts,this.order=t.data.data}))},deleteProduct(t){const l=`https://vue3-course-api.hexschool.io/api/yufang-api/cart/${t}`;this.$http.delete(l).then((t=>{this.$httpMessageState(t,"刪除"),this.getCart()}))},updateCart(t){const l=`https://vue3-course-api.hexschool.io/api/yufang-api/cart/${t.id}`;this.status.loadingItem=t.id;const a={product_id:t.id,qty:t.qty};this.$http.put(l,{data:a}).then((t=>{console.log(t.data),this.status.loadingItem="",this.getCart()}))}},created(){this.getProducts(),this.getCart()}},Z=a(89);const A=(0,Z.Z)(W,[["render",S]]);var B=A}}]);
//# sourceMappingURL=703.a87594dd.js.map