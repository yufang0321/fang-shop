"use strict";(self["webpackChunkfang_shop"]=self["webpackChunkfang_shop"]||[]).push([[941],{8941:function(t,l,s){s.r(l),s.d(l,{default:function(){return Z}});var e=s(3396),a=s(7139),i=s(9242);const n={class:"container"},o={class:"row mt-4"},d={class:"col-md-7"},r={class:"table align-middle"},u=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"圖片"),(0,e._)("th",null,"商品名稱"),(0,e._)("th",null,"價格"),(0,e._)("th",null,"數量"),(0,e._)("th")])],-1),c={style:{width:"200px"}},h=["onClick"],p={key:0,class:"h5"},g={key:1,class:"h6"},_={key:2,class:"h5"},b={class:"btn-toolbar justify-content-between",role:"toolbar","aria-label":"Toolbar with button groups"},y={class:"btn-group",role:"group","aria-label":"First group"},k=["onClick"],w=["onUpdate:modelValue"],v=["onClick"],m={class:"btn-group btn-group-sm"},C=["onClick"],f=(0,e._)("i",{class:"bi bi-three-dots"},null,-1),q=[f],x=["disabled","onClick"],z={key:0,class:"spinner-grow text-danger spinner-grow-sm",role:"status"},D=(0,e._)("span",{class:"visually-hidden"},"Loading...",-1),$=[D],P=(0,e._)("i",{class:"bi bi-cart-plus"},null,-1),I={class:"col-md-5"},L={class:"table align-middle"},Q=(0,e._)("thead",null,[(0,e._)("tr",null,[(0,e._)("th",null,"品名"),(0,e._)("th",null,"單價"),(0,e._)("th",null,"數量"),(0,e._)("th")])],-1),H={class:"h5"},U={class:"h5"},Y={class:"h5"},j=["onClick"],K=(0,e._)("i",{class:"bi bi-trash3"},null,-1),V=[K],F={class:"text-end h5"};function M(t,l,s,f,D,K){const M=(0,e.up)("LoadingComponent");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e.Wm)(M,{active:t.isLoading},null,8,["active"]),(0,e._)("div",n,[(0,e._)("div",o,[(0,e._)("div",d,[(0,e._)("table",r,[u,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(D.products,(t=>((0,e.wg)(),(0,e.iD)("tr",{key:t.id},[(0,e._)("td",c,[(0,e._)("div",{style:(0,a.j5)([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${t.imageUrl})`}])},null,4)]),(0,e._)("td",null,[(0,e._)("a",{class:"text-dark",onClick:l=>K.getProduct(t.id)},(0,a.zw)(t.title),9,h)]),(0,e._)("td",null,[t.price?(0,e.kq)("",!0):((0,e.wg)(),(0,e.iD)("div",p,(0,a.zw)(t.origin_price)+" 元",1)),t.price?((0,e.wg)(),(0,e.iD)("del",g,"原價 "+(0,a.zw)(t.origin_price)+" 元",1)):(0,e.kq)("",!0),t.price?((0,e.wg)(),(0,e.iD)("div",_,"現在只要 "+(0,a.zw)(t.price)+" 元",1)):(0,e.kq)("",!0)]),(0,e._)("td",null,[(0,e._)("div",b,[(0,e._)("div",y,[(0,e._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:l=>K.deleteQty(t)},"-",8,k),(0,e.wy)((0,e._)("input",{type:"number",class:"form-control","onUpdate:modelValue":l=>t.qty=l},null,8,w),[[i.nr,t.qty]]),(0,e._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:l=>K.addQty(t)},"+",8,v)])])]),(0,e._)("td",null,[(0,e._)("div",m,[(0,e._)("button",{type:"button",class:"btn btn-outline-secondary",onClick:l=>K.getProduct(t.id)},q,8,C),(0,e._)("button",{type:"button",class:"btn btn-outline-danger",disabled:this.status.loadingItem===t.id,onClick:l=>K.addCart(t.id,t.qty)},[this.status.loadingItem===t.id?((0,e.wg)(),(0,e.iD)("div",z,$)):(0,e.kq)("",!0),P],8,x)])])])))),128))])])]),(0,e._)("div",I,[(0,e._)("table",L,[Q,(0,e._)("tbody",null,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(D.carts,(t=>((0,e.wg)(),(0,e.iD)("tr",{key:t.id},[(0,e._)("td",null,[(0,e._)("a",H,(0,a.zw)(t.product.title),1)]),(0,e._)("td",null,[(0,e._)("div",U,(0,a.zw)(t.product.price)+" 元",1)]),(0,e._)("td",null,[(0,e._)("div",Y,(0,a.zw)(t.qty),1)]),(0,e._)("td",null,[(0,e._)("button",{type:"button",class:"btn btn-outline-danger",onClick:l=>K.deleteProduct(t.id)},V,8,j)])])))),128))])]),(0,e._)("div",null,[(0,e._)("p",F,"總計："+(0,a.zw)(D.order.final_total),1)])])])])],64)}s(560);var S={data(){return{products:[],product:{},carts:[],order:{},status:{loadingItem:""}}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/yufang-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products.filter(((t,l,s)=>(t.qty=0,t))),console.log("products:",this.products),this.isLoading=!1}))},getProduct(t){this.$router.push(`/user/product/${t}`)},addCart(t,l){const s="https://vue3-course-api.hexschool.io/api/yufang-api/cart";this.status.loadingItem=t;const e={product_id:t,qty:0===l?1:l};this.$http.post(s,{data:e}).then((t=>{this.status.loadingItem="",this.getCart()})),console.log("item.id:",t,"item.qty:",l)},addQty(t){t.qty+=1},deleteQty(t){t.qty>0&&(t.qty-=1)},getCart(){const t="https://vue3-course-api.hexschool.io/api/yufang-api/cart";this.$http.get(t).then((t=>{console.log("getCart:",t.data.data),this.carts=t.data.data.carts,this.order=t.data.data}))},deleteProduct(t){const l=`https://vue3-course-api.hexschool.io/api/yufang-api/cart/${t}`;this.$http.delete(l).then((t=>{this.$httpMessageState(t,"刪除"),this.getCart()}))}},created(){this.getProducts(),this.getCart()}},T=s(89);const W=(0,T.Z)(S,[["render",M]]);var Z=W}}]);
//# sourceMappingURL=941.403ac707.js.map